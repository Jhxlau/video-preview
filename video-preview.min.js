function vpInjectCSS() { var s = document.createElement('style'); s.innerHTML = ".video-preview-container{display:inline-block;position:relative}.video-preview-container video{display:block}.video-preview-container .controls{position:absolute;top:0;left:0;width:100%;height:calc(100% + 4px);display:flex;flex-direction:column}.video-preview-container .controls .progress{margin-top:auto;display:flex;height:4px;background:#ccc}.video-preview-container .controls .progress-bar{width:0%;height:100%;background-color:#000}.video-preview-container .controls .play-button{display:flex;flex-direction:column;justify-content:center;position:absolute;right:15px;bottom:15px;height:25px;width:25px;border:2px solid #dcdcdc;border-radius:50%;animation:1.5s infinite alternate preview-video-player-button-blink;cursor:pointer}.video-preview-container .controls .play-button::after{flex-basis:1;text-align:center;margin-left:2px;content:'â–¶';font-family:arial!important;font-size:15px;line-height:15px;color:#dcdcdc;animation:1.5s infinite alternate preview-video-player-button-blink}@keyframes preview-video-player-button-blink{0%{border-color:rgba(220,220,220,1);color:rgba(220,220,220,1)}100%{border-color:rgba(220,220,220,.2);color:rgba(220,220,220,.2)}}.video-preview-container.playing .play-button{transition:.5s opacity;opacity:0}.video-preview-container.loading{cursor:wait}"; document.head.appendChild(s); }
function initVideoPreview(t,e){e=Object.assign({cors:!1,loop:!0,muted:!0,autoplay:!1,preload:"auto"},e),"function"==typeof vpInjectCSS&&vpInjectCSS(),document.querySelectorAll(t).forEach(function(t){t._playing=!1;var n={loop:e.loop,muted:e.muted,crossorigin:e.cors,autoplay:e.autoplay,playsinline:1,controls:0};Object.keys(n).forEach(function(e){n[e]?t.setAttribute(e,n[e]):t.removeAttribute(e)}),["width","height","class"].forEach(function(e){var n=t.getAttribute(e);n&&t.setAttribute(e,n)});var a=document.createElement("div");a.classList.add("controls"),a.innerHTML="<div class=progress> <span class=progress-bar></span></div><div class=play-button></div>";var o=document.createElement("div");o.classList.add("video-preview-container"),t.parentNode.replaceChild(o,t),o.appendChild(t),o.appendChild(a);var i=o.querySelector(".controls .progress-bar");return t._updateProgress=function(){i.style.width=Math.floor(t.currentTime/t.duration*100)+"%"},t._play=function(){var e=function(){t._playing=!0,o.classList.add("playing")},n=t.play();n&&"function"==typeof n.then?n.then(e).catch(function(e){console.warn("state?",t.readyState)}):e()},t._stop=function(){var e=function(){t.currentTime=0,t._playing=!1,o.classList.remove("playing")},n=t.pause();n&&"function"==typeof n.then?n.then(e):e()},t._togglePlay=function(){t._playing?t._stop():t._play()},t._toggleLoadingState=function(e){return t._loading=e,e?o.classList.add("loading"):o.classList.remove("loading")},t._toggleLoadingState(!0),o.addEventListener("mouseover",t._play),o.addEventListener("mouseout",t._stop),o.addEventListener("click",t._togglePlay),t.addEventListener("timeupdate",t._updateProgress),t.addEventListener("canplaythrough",function(){t._toggleLoadingState(!1)}),o})}
